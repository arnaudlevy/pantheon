<div class="row mt-5">
    <div class="col-md-2 offset-md-5 mb-5 col-8 offset-2">
        <%= render 'personalities/personality_photo', photo: @personality.photo %>
    </div>
</div>
<h1 class="mb-1"><%= @personality %></h1>
<p class="text-center small mb-5">
    <%= link_to @personality.wikipedia_url, @personality.wikipedia_url, target: :_blank, class: 'small' %>
</p>

<% if @personality.choices.none? %>
    <div class="mb-3">
        <p>Cette page est une erreur ?</p>
        <%= link_to 'Supprimer', @personality, method: :delete, class: 'btn btn-danger btn-sm' %>
    </div>
<% end %>
<div class="row">
    <div class="col-md-6 offset-md-3">
        <%= raw @personality.description %>
        <hr class="mb-5 mt-5" />
        <h2>Mon Panthéon personnel</h2>
        <% if user_signed_in? %>
            <% if @choice.new_record? %>
                <h3><%= @personality %> n'est pas dans mon Panthéon</h3>
                <p>L'ajouter ?</p>
            <% else %>
                <h3><%= @personality %> est dans mon Panthéon</h3>
            <% end %>
            <%= form_for @choice do |f| %>
                <%= f.hidden_field :personality_id %>
                <%= f.hidden_field :user_id %>
                <%= f.text_area :description, class: 'form-control', placeholder: 'Pourquoi cette personnalité est-elle dans mon Panthéon?' %>
                <%= submit_tag 'Enregistrer', class: 'btn btn-primary btn-sm mt-3' %>
                <%= link_to 'Enlever', @choice, method: :delete, class: 'btn btn-danger btn-sm mt-3' %>
            <% end %>
        <% else %>
            <p>Pour pouvoir créer votre Panthéon personnel, vous devez vous inscrire ou vous connecter.</p>
            <%= link_to 'Inscription', new_user_registration_path, class: 'btn btn-primary' %>
            <%= link_to 'Connexion', new_user_session_path, class: 'btn btn-primary' %>
        <% end %>
        <div class="mt-3">
            <h3><%= @personality %> est dans le Panthéon de...</h3>
            <ul class="list-unstyled">
                <% @personality.users.each do |user| %>
                    <li><%= link_to user, user %></li>
                <% end %>
            </ul>
        </div>
    </div>
</div>

